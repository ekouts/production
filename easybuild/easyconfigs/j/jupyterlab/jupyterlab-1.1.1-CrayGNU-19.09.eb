# @author: robinson 
easyblock = 'Bundle'

name = 'jupyterlab'
version = '1.1.1'

homepage = 'https://github.com/jupyterlab/jupyterlab'
description = "An extensible environment for interactive and reproducible computing, based on the Jupyter Notebook and Architecture."

toolchain = {'name': 'CrayGNU', 'version': '19.09'}
toolchainopts = {'pic': True, 'verbose': False}

dependencies = [
    ('libffi', '3.2.1', '', True),
    ('PyExtensions', '3.6.5.7'),
    ('IPython', '7.7.0', '-python3'),
    ('configurable-http-proxy', '3.1.1'),
    ('dask', '2.2.0', '-python3'),
    ('graphviz', '2.40.1', '', True),
]  # 'for i in $(find %s); do chmod +r $i; done' % julia_depot_path;

exts_list = [
    ('pyrsistent', '0.15.4', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/p/pyrsistent/'], 'req_py_minver': '6'}),
    ('attrs', '19.1.0', {'use_pip': True, 'req_py_majver': '3', 'modulename': 'attr', 'source_urls': ['https://pypi.python.org/packages/source/a/attrs/'], 'req_py_minver': '6'}),
    ('jsonschema', '3.0.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/jsonschema/'], 'req_py_minver': '6'}),
    ('json5', '0.8.5', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/json5/'], 'req_py_minver': '6'}),
    ('Send2Trash', '1.5.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/s/Send2Trash/'], 'req_py_minver': '6'}),
    ('tornado', '6.0.3', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/t/tornado/'], 'req_py_minver': '6'}),
    ('pyzmq', '18.0.2', {'use_pip': True, 'req_py_majver': '3', 'modulename': 'zmq', 'source_urls': ['https://pypi.python.org/packages/source/p/pyzmq/'], 'req_py_minver': '6'}),
    ('python-dateutil', '2.8.0', {'use_pip': True, 'req_py_majver': '3', 'modulename': 'dateutil', 'source_urls': ['https://pypi.python.org/packages/source/p/python-dateutil/'], 'req_py_minver': '6'}),
    ('jupyter_core', '4.5.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/jupyter_core/'], 'req_py_minver': '6'}),
    ('jupyter_client', '5.3.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/jupyter_client/'], 'req_py_minver': '6'}),
    ('MarkupSafe', '1.1.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/m/MarkupSafe/'], 'req_py_minver': '6'}),
    ('Jinja2', '2.10.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/Jinja2/'], 'req_py_minver': '6'}),
    ('webencodings', '0.5.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/w/webencodings/'], 'req_py_minver': '6'}),
    ('bleach', '3.1.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/b/bleach/'], 'req_py_minver': '6'}),
    ('defusedxml', '0.6.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/d/defusedxml/'], 'req_py_minver': '6'}),
    ('entrypoints', '0.3', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/e/entrypoints/'], 'req_py_minver': '6'}),
    ('mistune', '0.8.4', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/m/mistune/'], 'req_py_minver': '6'}),
    ('nbformat', '4.4.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/n/nbformat/'], 'req_py_minver': '6'}),
    ('pandocfilters', '1.4.2', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/p/pandocfilters/'], 'req_py_minver': '6'}),
    ('testpath', '0.4.2', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/t/testpath/'], 'req_py_minver': '6'}),
    ('nbconvert', '5.5.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/n/nbconvert/'], 'req_py_minver': '6'}),
    ('prometheus_client', '0.7.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/p/prometheus_client/'], 'req_py_minver': '6'}),
    ('terminado', '0.8.2', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/t/terminado/'], 'req_py_minver': '6'}),
    ('jupyterlab_server', '1.0.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/jupyterlab_server/'], 'req_py_minver': '6'}),
    ('ipykernel', '5.1.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/i/ipykernel/'], 'req_py_minver': '6'}),
    ('notebook', '6.0.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/n/notebook/'], 'req_py_minver': '6'}),
    ('jupyterlab', '1.1.1', {'use_pip': True, 'installopts': ' --install-option=--skip-npm ', 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/jupyterlab/'], 'req_py_minver': '6'}),
    ('SQLAlchemy', '1.3.6', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/s/SQLAlchemy/'], 'req_py_minver': '6'}),
    ('Mako', '1.0.14', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/m/Mako/'], 'req_py_minver': '6'}),
    ('alembic', '1.0.11', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/a/alembic/'], 'req_py_minver': '6'}),
    ('python-editor', '1.0.4', {'use_pip': True, 'req_py_majver': '3', 'modulename': 'editor', 'source_urls': ['https://pypi.python.org/packages/source/p/python-editor/'], 'req_py_minver': '6'}),
    ('async_generator', '1.10', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/a/async_generator/'], 'req_py_minver': '6'}),
    ('pycparser', '2.19', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/p/pycparser/'], 'req_py_minver': '6'}),
    ('cffi', '1.12.3', {'use_pip': False, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/c/cffi/'], 'req_py_minver': '6'}),
    ('asn1crypto', '0.24.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/a/asn1crypto/'], 'req_py_minver': '6'}),
    ('cryptography', '2.7', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/c/cryptography/'], 'req_py_minver': '6'}),
    ('pyOpenSSL', '19.0.0', {'use_pip': True, 'req_py_majver': '3', 'modulename': 'OpenSSL', 'source_urls': ['https://pypi.python.org/packages/source/p/pyOpenSSL/'], 'req_py_minver': '6'}),
    ('certipy', '0.1.3', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/c/certipy/'], 'req_py_minver': '6'}),
    ('entrypoints', '0.3', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/e/entrypoint/'], 'req_py_minver': '6'}),
    ('oauthlib', '3.0.2', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/o/oauthlib/'], 'req_py_minver': '6'}),
    ('pamela', '1.0.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/p/pamela/'], 'req_py_minver': '6'}),
    ('urllib3', '1.25.3', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/u/urllib3/'], 'req_py_minver': '6'}),
    ('idna', '2.8', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/i/idna/'], 'req_py_minver': '6'}),
    ('chardet', '3.0.4', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/c/chardet/'], 'req_py_minver': '6'}),
    ('certifi', '2019.6.16', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/c/certifi/'], 'req_py_minver': '6'}),
    ('requests', '2.22.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/r/requests/'], 'req_py_minver': '6'}),
    ('jupyterhub', '1.0.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/jupyterhub/'], 'req_py_minver': '6'}),
    ('widgetsnbextension', '3.5.1', {'source_urls': ['https://pypi.python.org/packages/source/w/widgetsnbextension/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('ipywidgets', '7.5.1', {'source_urls': ['https://pypi.python.org/packages/source/i/ipywidgets/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('ipympl', '0.3.3', {'source_urls': ['https://pypi.python.org/packages/source/i/ipympl/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('retrying', '1.3.3', {'source_urls': ['https://pypi.python.org/packages/source/r/retrying/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('plotly', '4.0.0', {'source_urls': ['https://pypi.python.org/packages/source/p/plotly/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('PyYAML', '5.1.2', {'source_urls': ['https://pypi.python.org/packages/source/p/PyYAML/'], 'req_py_majver': '3', 'modulename': 'yaml', 'req_py_minver': '6'}),
    ('bokeh', '1.3.4', {'source_urls': ['https://pypi.python.org/packages/source/b/bokeh/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('packaging', '19.1', {'source_urls': ['https://pypi.python.org/packages/source/p/packaging/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('Pillow', '6.1.0', {'source_urls': ['https://pypi.python.org/packages/source/p/Pillow/'], 'req_py_majver': '3', 'modulename': 'PIL', 'req_py_minver': '6'}),
    ('traittypes', '0.2.1', {'source_urls': ['https://pypi.python.org/packages/source/t/traittypes/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('bqplot', '0.11.6', {'source_urls': ['https://pypi.python.org/packages/source/b/bqplot/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('psutil', '5.6.3', {'source_urls': ['https://pypi.python.org/packages/source/p/psutil/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('nbresuse', '0.3.2', {'source_urls': ['https://pypi.python.org/packages/source/n/nbresuse/'], 'req_py_majver': '3', 'req_py_minver': '6'}),
    ('graphviz', '0.12', {'use_pip': True, 'req_py_majver': '3', 'source_tmpl': 'graphviz-%(version)s.zip', 'source_urls': ['https://pypi.python.org/packages/source/g/graphviz/'], 'req_py_minver': '6'}),
    ('simpervisor', '0.3', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/s/simpervisor/'], 'req_py_minver': '6'}),
    ('multidict', '4.5.2', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/m/multidict/'], 'req_py_minver': '6'}),
    ('yarl', '1.3.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/y/yarl/'], 'req_py_minver': '6'}),
    ('typing_extensions', '3.7.4', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/t/typing_extensions/'], 'req_py_minver': '6'}),
    ('async-timeout', '3.0.1', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/a/async-timeout/'], 'req_py_minver': '6'}),
    ('idna-ssl', '1.1.0', {'use_pip': True, 'req_py_majver': '3', 'modulename': 'idna_ssl', 'source_urls': ['https://pypi.python.org/packages/source/i/idna-ssl/'], 'req_py_minver': '6'}),
    ('aiohttp', '3.5.4', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/a/aiohttp/'], 'req_py_minver': '6'}),
    ('jupyter-server-proxy', '1.1.0', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/j/jupyter-server-proxy/'], 'req_py_minver': '6'}),
    ('dask_labextension', '1.0.3', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/d/dask-labextension/'], 'req_py_minver': '6'}),
    ('bash_kernel', '0.7.2', {'use_pip': True, 'req_py_majver': '3', 'source_urls': ['https://pypi.python.org/packages/source/b/bash_kernel/'], 'req_py_minver': '6'}),
]
# For Julia packages needed for Jupyter
#twr julia_depot_path = "%(installdir)s/share/julia/site/"
modextrapaths = {'PYTHONPATH': ['lib/python3.6/site-packages'], 'JUPYTER_PATH': 'share/jupyter'}
# install extensions
# jupyterlab/hub-extension no longer needed as the hub menu is built into jupyterlab core from JLab 1.x, twr
postinstallcmds = ['export YARN_CACHE_FOLDER=/tmp/$USER/yarn_cache;export JUPYTERLAB_DIR=%(installdir)s/share/jupyter/lab/;export PYTHONPATH=%(installdir)s/lib/python3.6/site-packages:$PYTHONPATH;export JUPYTER_DATA_DIR=%(installdir)s/share/jupyter/;export JULIA_DEPOT_PATH=%(installdir)s/share/julia/site/;export JUPYTER=%(installdir)s/bin/jupyter;%(installdir)s/bin/jupyter-labextension install -y @jupyter-widgets/%(name)s-manager@1.0 --no-build;%(installdir)s/bin/jupyter labextension install jupyter-matplotlib --no-build;%(installdir)s/bin/jupyter labextension install -y plotlywidget@1.0.0 --no-build;%(installdir)s/bin/jupyter labextension install -y %(name)s-plotly@1.0.0 --no-build;%(installdir)s/bin/jupyter labextension install -y %(name)s-chart-editor@1.2 --no-build;%(installdir)s/bin/jupyter labextension install -y jupyterlab_bokeh@1.0.0 --no-build;%(installdir)s/bin/jupyter labextension install -y bqplot@0.4.6 --no-build;%(installdir)s/bin/jupyter labextension install %(name)s-topbar-extension %(name)s-system-monitor --no-build;%(installdir)s/bin/jupyter labextension install dask-labextension --no-build;%(installdir)s/bin/jupyter lab build --dev-build=False;rm -r $YARN_CACHE_FOLDER;python3 -m bash_kernel.install --prefix=%(installdir)s/;']
# bundle of Python packages
exts_defaultclass = 'PythonPackage'
modextravars = {'JUPYTERLAB_DIR': '%(installdir)s/share/jupyter/lab/', 'JUPYTER': '%(installdir)s/bin/jupyter'}

sanity_check_paths = {
    'files': [],
    'dirs': ['lib/python3.6/site-packages', 'share/jupyter/lab/extensions', 'share/jupyter/lab/schemas', 'share/jupyter/lab/staging', 'share/jupyter/lab/static', 'share/jupyter/lab/themes'],
}

moduleclass = 'tools'
